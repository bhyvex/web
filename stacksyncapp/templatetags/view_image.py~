from django import template
import requests
import json

register = template.Library()

@register.simple_tag

def get_image(file_id , token_id):
	url = 'https://cloudspaces.urv.cat:8080/v1/AUTH_e685194ffd724f55bd7f6ad14dc5bec7/stacksync/files?file_id='+file_id
	headers = {'Stacksync-api':'true', 'x-auth-token': token_id}
		
	local_filename = "temporaryfile"
	r = requests.get(url, headers=headers, verify=False, stream=True)
	with open(local_filename, 'wb') as f:
        	for chunk in r.iter_content(chunk_size=1024): 
            		if chunk: # filter out keep-alive new chunks
                		f.write(chunk)
                		f.flush()
    
